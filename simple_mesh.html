<!--
Copyright (c) 2016, Los Alamos National Security, LLC
All rights reserved.
Copyright 2016. Los Alamos National Security, LLC. This software was produced
under U.S. Government contract DE-AC52-06NA25396 for Los Alamos National
Laboratory (LANL), which is operated by Los Alamos National Security, LLC for
the U.S. Department of Energy. The U.S. Government has rights to use,
reproduce, and distribute this software.  NEITHER THE GOVERNMENT NOR LOS ALAMOS
NATIONAL SECURITY, LLC MAKES ANY WARRANTY, EXPRESS OR IMPLIED, OR ASSUMES ANY
LIABILITY FOR THE USE OF THIS SOFTWARE.  If software is modified to produce
derivative works, such modified software should be clearly marked, so as not to
confuse it with the version available from LANL.
Additionally, redistribution and use in source and binary forms, with or
without modification, are permitted provided that the following conditions are
met:
1. Redistributions of source code must retain the above copyright notice,
   this list of conditions and the following disclaimer.
2. Redistributions in binary form must reproduce the above copyright
   notice, this list of conditions and the following disclaimer in the
   documentation and/or other materials provided with the distribution.
3. Neither the name of Los Alamos National Security, LLC, Los Alamos
   National Laboratory, LANL, the U.S. Government, nor the names of its
   contributors may be used to endorse or promote products derived from this
   software without specific prior written permission.
THIS SOFTWARE IS PROVIDED BY LOS ALAMOS NATIONAL SECURITY, LLC AND
CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A
PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL LOS ALAMOS NATIONAL
SECURITY, LLC OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR
BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER
IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
POSSIBILITY OF SUCH DAMAGE.
-->
<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <!-- For Mobile Devices -->
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <!-- Font stuff -->
    <link href='https://fonts.googleapis.com/css?family=Roboto+Slab' rel='stylesheet' type='text/css'/>
    <!-- Font Awesome -->
    <!--    <link rel="stylesheet" href="font-awesome-4.3.0/css/font-awesome.min.css"/> -->
    <script src="https://use.fontawesome.com/3dce4d8e65.js"></script>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    <meta name="generator" content="Doxygen 1.8.11"/>
    <script type="text/javascript" src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
    <title>portage: Simple Mesh Example</title>
    <script type="text/javascript" src="dynsections.js"></script>
    <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
    <link href="doxygen.css" rel="stylesheet" type="text/css" />
    <link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"/>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="doxy-boot.js"></script>
  </head>
  <body>
    <nav class="navbar navbar-default" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <a class="navbar-brand">portage 1.0.alpha</a>
        </div>
      </div>
    </nav>
    <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
      <div class="content" id="content">
        <div class="container">
          <div class="row">
            <div class="col-sm-12 panel " style="padding-bottom: 15px;">
              <div style="margin-bottom: 15px;">
		<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="quickstart.html"><span>Quick&#160;Start</span></a></li>
      <li><a href="simple_mesh.html"><span>Example&#160;Use</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Simple Mesh Example </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>portage provides very crude mesh and state manager frameworks, aptly called <code>Simple_Mesh</code> and <code>Simple_State</code>. The goal of these frameworks is to show how you can wrap your favorite mesh and state manager for use with portage.</p>
<h2>High-level portage Workflow</h2>
<p>portage provides library functions for remapping data from one mesh (the <em>source</em> mesh) to a a different mesh (the <em>target mesh</em>). In order to do this, portage needs to <em>search</em> through the source mesh for possible intersections with each mesh entity in the target mesh, actually calculate the amount of <em>intersection</em> with the candidates, and then <em>interpolate</em> the weighted results onto the target mesh.</p>
<h2>Why Wrappers?</h2>
<p>In order to perform the <em>search</em>, <em>intersect</em>, and <em>interpolate</em> steps of a remap, portage needs to ask the mesh and statemanager for information about data, connectivity/neighbors, etc. In order to do this in a general way, we have adopted wrappers around mesh frameworks that should implement the queries required by portage. It is then up to the user of the mesh and state manager of choice to make sure those queries are satisfied, in whatever (read: optimal) choice they choose.</p>
<h2><code><a class="el" href="namespaceAuxMeshTopology.html">AuxMeshTopology</a></code></h2>
<p>To facilitate wrapping, we provide a class called <a class="el" href="classPortage_1_1AuxMeshTopology.html">Portage::AuxMeshTopology</a>, which implements the <a href="https://en.wikipedia.org/wiki/Curiously_recurring_template_pattern">Curiously Recurring Template Pattern</a> to implement static polymorphism. In short, this means that <a class="el" href="namespaceAuxMeshTopology.html">AuxMeshTopology</a> is templated on a mesh wrapper class, which should be able to answer basic questions about cells and nodes (and faces and edges, depending on the dimension). <a class="el" href="namespaceAuxMeshTopology.html">AuxMeshTopology</a> then can build more advanced mesh connectivity information, such as sides, wedges, and corners (see the <em>Simple Mesh</em> section below).</p>
<p>A concrete example is the <a class="el" href="classPortage_1_1AuxMeshTopology.html#a72a7e33a70f9b88f974a377858e63f32" title="Number of items of given entity. ">Portage::AuxMeshTopology::num_entities()</a> function. This function takes a <a class="el" href="namespacePortage.html#a762e851d5a6ada63ea496d767679cffb" title="The type of mesh entity. ">Portage::Entity_kind</a> ( e.g. <a class="el" href="namespacePortage.html#a762e851d5a6ada63ea496d767679cffba4de14b554697e00c4c737bffa0af99d9">Portage::CELL</a> or <a class="el" href="namespacePortage.html#a762e851d5a6ada63ea496d767679cffba5ec35a5fce36c4b374bd936159beded4">Portage::NODE</a>) and a <a class="el" href="namespacePortage.html#a650a8718a706648846a2915b90612849" title="The parallel type of a given entity. ">Portage::Entity_type</a> (e.g. <a class="el" href="namespacePortage.html#a650a8718a706648846a2915b90612849a81595f3b7771b2f92ea4da160ca8794a">Portage::PARALLEL_OWNED</a> or <a class="el" href="namespacePortage.html#a650a8718a706648846a2915b90612849ae4946387180ec3e74dea905a3bd3eba0">Portage::PARALLEL_GHOST</a>) and returns the appropriate number of entities of that type and kind. Under the hood, it calls the base mesh wrapper class' functions (e.g. <a class="el" href="classPortage_1_1Simple__Mesh__Wrapper.html#ae6fa7dd6cbc4008c7ef2da6a897b8937" title="The number of OWNED faces in the mesh. ">Portage::Simple_Mesh_Wrapper::num_owned_faces()</a>) where applicable, or can call its own functions for information about more advanced entities (e.g. <a class="el" href="classPortage_1_1AuxMeshTopology.html#ad9bb2bcd54b0d744d8a4082b65863534" title="Number of ghost sides in the mesh. ">Portage::AuxMeshTopology::num_ghost_sides()</a>).</p>
<p><b>NOTE:</b> When wrapping a new mesh framework, one does not <em>need</em> to use <a class="el" href="namespaceAuxMeshTopology.html">AuxMeshTopology</a>, especially if your mesh framework already supports the advanced mesh entities; it is simply a convenience tool.</p>
<h2>Methods Wrapped</h2>
<p>This is a list of methods needed by a mesh wrapper during a typical flow through portage. This is the list of things needed with and in addition to using <a class="el" href="classPortage_1_1AuxMeshTopology.html">Portage::AuxMeshTopology</a> class. The examples here are concrete examples using the <a class="el" href="classPortage_1_1Simple__Mesh__Wrapper.html" title="A thin wrapper that implements mesh methods for Simple_Mesh. ">Portage::Simple_Mesh_Wrapper</a> class as a reference.</p>
<dl>
<dt>General mesh info </dt>
<dd><a class="el" href="classPortage_1_1Simple__Mesh__Wrapper.html#a12ed4bb7a0ee480d0dc818a4fcb791d8" title="The spatial dimension of the mesh. ">Portage::Simple_Mesh_Wrapper::space_dimension()</a> <a class="el" href="classPortage_1_1Simple__Mesh__Wrapper.html#acd72278e9ad70f1621f71f1a6f798cc0" title="Get the Entity_type (e.g. PARALLEL_OWNED) of a specific cell. ">Portage::Simple_Mesh_Wrapper::cell_get_type()</a> <a class="el" href="classPortage_1_1Simple__Mesh__Wrapper.html#adf77d0eb1adc6c53d4a1797873786a4e" title="Get the Element_type (e.g. HEX) of a specific cell. ">Portage::Simple_Mesh_Wrapper::cell_get_element_type()</a> <a class="el" href="classPortage_1_1Simple__Mesh__Wrapper.html#a9beadc12b3a39b520228ab159eb822dd" title="Get the global ID. NOTE: Simple_Mesh only has local IDs. ">Portage::Simple_Mesh_Wrapper::get_global_id()</a> </dd>
<dt><code>num_X_Y</code> for various entities </dt>
<dd><a class="el" href="classPortage_1_1Simple__Mesh__Wrapper.html#a91da78b050d6de2b32f8f845e31c6b51" title="The number of OWNED cells in the mesh. ">Portage::Simple_Mesh_Wrapper::num_owned_cells()</a> <a class="el" href="classPortage_1_1Simple__Mesh__Wrapper.html#ae6fa7dd6cbc4008c7ef2da6a897b8937" title="The number of OWNED faces in the mesh. ">Portage::Simple_Mesh_Wrapper::num_owned_faces()</a> <a class="el" href="classPortage_1_1Simple__Mesh__Wrapper.html#a67b67a39f65c8a8945a403fc784cd90d" title="The number of ONWED nodes in the mesh. ">Portage::Simple_Mesh_Wrapper::num_owned_nodes()</a> <a class="el" href="classPortage_1_1Simple__Mesh__Wrapper.html#a04928feed30ef559758e8abc809d19c1" title="The number of GHOST cells in the mesh. ">Portage::Simple_Mesh_Wrapper::num_ghost_cells()</a> <a class="el" href="classPortage_1_1Simple__Mesh__Wrapper.html#af123b29282e63c937254726b683aa0b2" title="The number of GHOST faces in the mesh. ">Portage::Simple_Mesh_Wrapper::num_ghost_faces()</a> <a class="el" href="classPortage_1_1Simple__Mesh__Wrapper.html#ace0afa9cfadad0141e7ec8cffa96818f" title="The number of GHOST nodes in the mesh. ">Portage::Simple_Mesh_Wrapper::num_ghost_nodes()</a> </dd>
<dt>Connectivity information </dt>
<dd><a class="el" href="classPortage_1_1Simple__Mesh__Wrapper.html#a63a6e209bcca80ebdb0bfabadd2078e2" title="Get the list of node IDs for all nodes attached to all cells attached to a specific node...">Portage::Simple_Mesh_Wrapper::node_get_cell_adj_nodes()</a> <a class="el" href="classPortage_1_1Simple__Mesh__Wrapper.html#a62f26c8aff4ffb75b2b26ec2a125a158" title="Get the list of cell IDs for all cells attached to a specific cell through its nodes. ">Portage::Simple_Mesh_Wrapper::cell_get_node_adj_cells()</a> <a class="el" href="classPortage_1_1Simple__Mesh__Wrapper.html#a4e5ceef2b645462a216eef9bfa99b22f" title="Get the list of face IDs and face normal directions for a specific cell. ">Portage::Simple_Mesh_Wrapper::cell_get_faces_and_dirs()</a> <a class="el" href="classPortage_1_1Simple__Mesh__Wrapper.html#ae2890c04e80e64a12367f84d07b310b5" title="Get the list of node IDs for a specific cell. ">Portage::Simple_Mesh_Wrapper::cell_get_nodes()</a> <a class="el" href="classPortage_1_1Simple__Mesh__Wrapper.html#ae32ab991ff346de484297e42675a2726" title="Get the list of node IDs for a specific face. ">Portage::Simple_Mesh_Wrapper::face_get_nodes()</a> </dd>
<dt>Spatial information </dt>
<dd><a class="el" href="classPortage_1_1Simple__Mesh__Wrapper.html#a74e43abf79c1a955744388d2e02bbe1a" title="Get the coordinates of a specific node as a Portage::Point. ">Portage::Simple_Mesh_Wrapper::node_get_coordinates()</a> </dd>
</dl>
<h2>Simple Mesh</h2>
<p>The <a class="el" href="classPortage_1_1Simple__Mesh.html" title="A very light-weight, serial, 3D Cartesian mesh. ">Portage::Simple_Mesh</a> class provides a concrete example of a basic regular Cartesian mesh framework in 3d. Simple_Mesh is <em>not</em> designed for production, and is currently only serial-capable &ndash; it does not have any ghost information, so queries to ghost entities simply return 0.</p>
<p>Simple_Mesh only knows about cells, faces, and nodes. A Simple_Mesh is constructed by passing in the lower and upper extents of the rectangular prism that makes up the domain, and the number of cells in each direction. All the cells, faces, and nodes are then created as simple indices, and connectivity is built from these indices with an assumed ordering, as shown below.</p>
<div class="image">
<img src="cell-blowup.png" alt="cell-blowup.png"/>
<div class="caption">
Blowup of local node ordering.</div></div>
 <div class="image">
<img src="cell-faces.png" alt="cell-faces.png"/>
<div class="caption">
Local face ordering for a cell.</div></div>
<div class="image">
<img src="allNodes.svg" alt="allNodes.svg"/>
<div class="caption">
Global node ordering.</div></div>
<div class="image">
<img src="xy_plane.svg" alt="xy_plane.svg"/>
<div class="caption">
Global numbering of xy-plane faces</div></div>
<div class="image">
<img src="yz_plane.svg" alt="yz_plane.svg"/>
<div class="caption">
Global numbering of yz-plane faces</div></div>
<div class="image">
<img src="xz_plane.svg" alt="xz_plane.svg"/>
<div class="caption">
Global numbering of xz-plane faces</div></div>
<h2>Simple State</h2>
<p>The state manager associated with the <a class="el" href="classPortage_1_1Simple__Mesh.html" title="A very light-weight, serial, 3D Cartesian mesh. ">Portage::Simple_Mesh</a> framwork is Simple_State. The field data is stored within a STL vectors inside a map that maps a <code>(var_name, Entity_kind)</code> pair key to the data. The global indices stored within Simple_Mesh correspond to the specific index into the vector of field data stored in Simple_State. </p>
</div></div><!-- contents -->
<!--
Copyright (c) 2016, Los Alamos National Security, LLC
All rights reserved.
Copyright 2016. Los Alamos National Security, LLC. This software was produced
under U.S. Government contract DE-AC52-06NA25396 for Los Alamos National
Laboratory (LANL), which is operated by Los Alamos National Security, LLC for
the U.S. Department of Energy. The U.S. Government has rights to use,
reproduce, and distribute this software.  NEITHER THE GOVERNMENT NOR LOS ALAMOS
NATIONAL SECURITY, LLC MAKES ANY WARRANTY, EXPRESS OR IMPLIED, OR ASSUMES ANY
LIABILITY FOR THE USE OF THIS SOFTWARE.  If software is modified to produce
derivative works, such modified software should be clearly marked, so as not to
confuse it with the version available from LANL.
Additionally, redistribution and use in source and binary forms, with or
without modification, are permitted provided that the following conditions are
met:
1. Redistributions of source code must retain the above copyright notice,
   this list of conditions and the following disclaimer.
2. Redistributions in binary form must reproduce the above copyright
   notice, this list of conditions and the following disclaimer in the
   documentation and/or other materials provided with the distribution.
3. Neither the name of Los Alamos National Security, LLC, Los Alamos
   National Laboratory, LANL, the U.S. Government, nor the names of its
   contributors may be used to endorse or promote products derived from this
   software without specific prior written permission.
THIS SOFTWARE IS PROVIDED BY LOS ALAMOS NATIONAL SECURITY, LLC AND
CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A
PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL LOS ALAMOS NATIONAL
SECURITY, LLC OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR
BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER
IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
POSSIBILITY OF SUCH DAMAGE.
-->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
</div>
</div>
</div>
</div>
</div>
<!--<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address> -->
<footer id="footer" class="footer">
  <div class="container">
    <div class="row test-muted">
      <div class="footer-row col-md-6">Copyright &copy; 2016
	<a href="http://lanl.gov"> Los Alamos National Security, LLC</a>
	All Rights Reserved.
      </div>
      <div class="footer-row col-md-2">
	<a href="https://github.com/laristra/portage/blob/master/LICENSE">
	  BSD LICENSE
	</a>
      </div>
      <div class="footer-row col-md-2">
	LA-CC-16-084
      </div>
      <div class="footer-row col-md-1">
	<a href="mailto:portage@lanl.gov">
	  <i class="fa fa-envelope-o fa-2x"></i>
	</a>
      </div>
      <div class="footer-row col-md-1">
	<a href="https://github.com/laristra/portage">
	  <i class="fa fa-github fa-2x"></i>
	</a>
      </div>
    </div>
  </div>
</footer>
</body>
</html>
